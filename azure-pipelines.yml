# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

variables:
- group: Credentials

jobs:
  - job:

    steps:
    - script: |
        node --version
        sudo npm i -g @antora/cli@2.3 @antora/site-generator-default@2.3
        antora version
      displayName: 'Install antora'

    - script: |
        export GIT_CREDENTIALS='https://$(PAT):@github.com'
        antora --fetch --to-dir '$(Build.ArtifactStagingDirectory)' antora-playbook.yml
      displayName: 'Run antora'

    - publish: '$(Build.ArtifactStagingDirectory)/site'
      artifact: 'ssat-tech-docs'